import { Texture } from 'texture'
import { validateXML } from 'texture-xml-utils'
import JATSArchiving10 from './JATSArchiving-1.0.js'
import JATSArchiving11 from './JATS-Archiving-1-1-MathML3'
import JATSArchiving12 from './JATS-Archiving-1-2-MathML3'

// EXPERIMENTAL: at the moment, we do not necessarily need this
// as a Texture plugin. We only use it for development, to be able to
// validate output generated by Texture against the particular JATS DTDs.
// When this plugin is loaded, any JATS file will be validated during loading.
Texture.registerPlugin({
  name: 'jats-plugin',
  description: 'Provides JATS validators',
  configure (configurator) {
    let articleConfig = configurator.getConfiguration('article')
    articleConfig.registerSchemaId(JATSArchiving10.publicId)
    articleConfig.addValidator(JATSArchiving10.publicId, {
      validate (xmlDom) {
        return validateXML(JATSArchiving10, xmlDom)
      }
    })
    articleConfig.registerSchemaId(JATSArchiving11.publicId)
    articleConfig.addValidator(JATSArchiving11.publicId, {
      validate (xmlDom) {
        return validateXML(JATSArchiving11, xmlDom)
      }
    })
    articleConfig.registerSchemaId(JATSArchiving12.publicId)
    articleConfig.addValidator(JATSArchiving12.publicId, {
      validate (xmlDom) {
        return validateXML(JATSArchiving12, xmlDom)
      }
    })
  }
})
